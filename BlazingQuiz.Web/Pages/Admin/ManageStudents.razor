@page "/admin/manage-students"


@inject IUserApi UserApi

<QuickGrid ItemsProvider="_usersProvider">
	<PropertyColumn Property="u => u.Id" />
	<PropertyColumn Property="u => u.Name" />
	<PropertyColumn Property="u => u.Email" />
	<PropertyColumn Property="u => u.Phone" />

	<TemplateColumn Title="Подтверждён?">
		<div class="form-check form-switch">
			<input class="form-check-input" type="checkbox" role="switch" id="u_@context.Id" />
			<label class="form-check-label" for="u_@context.Id">
				@(context.IsApproved ? "Да" : "Нет")
			</label>
		</div>
	</TemplateColumn>
</QuickGrid>

@code {
	private const int DefaultPageSize = 10;
	private GridItemsProvider<UserDto> _usersProvider;

	private UserApprovedFilter _filter = UserApprovedFilter.All;

	protected override void OnInitialized()
	{
		_usersProvider = async request =>
		{
			var pagedResult = await UserApi.GetUsersAsync(_filter, request.StartIndex, request.Count ?? DefaultPageSize);
			return GridItemsProviderResult.From(pagedResult.Records, pagedResult.TotalCount);
		};
	}
}
